define("saber-widget/RadioGroup",["require","saber-lang","saber-dom","saber-string/format","./Widget","./main"],function(require){function t(t){this.attrs={datasource:{value:[],repaint:!0},value:{value:null,setter:this.syncValue}},o.call(this,t)}function e(t,e){return"[data-"+t+(e?'="'+e+'"':"")+"]"}var n=require("saber-lang"),i=require("saber-dom"),r=require("saber-string/format"),o=require("./Widget"),a='<div data-role="radio" data-value="${value}"${checked}>${name}</div>',s=e("role","radio");return t.prototype.type="RadioGroup",t.prototype.initOptions=function(t){if(o.prototype.initOptions.call(this,t),!this.get("datasource").length&&!this.get("value"))this.addState("prerender"),this.extractData()},t.prototype.initEvent=function(){this.addEvent(this.get("main"),"click",this.clickHandler),this.on("propertychange",this.propertyChangeHandler)},t.prototype.propertyChangeHandler=function(t,e,n,i){if("value"===e)this.emit("valuechange",n,i)},t.prototype.syncValue=function(t){if(!this.is("prerender")){var e=this.getItemByValue(t),n=this.get("value"),r=this.getItemByValue(n);if(t!==n){if(r)i.removeData(r,"checked");if(e)i.setData(e,"checked",!0)}}},t.prototype.getItemByValue=function(t){if(!t)return null;else return i.query(e("value",t),this.get("main"))},t.prototype.clickHandler=function(t){var e=i.closest(t.target,s,this.get("main"));if(e){var n=this.get("value"),r=i.getData(e,"value");this.set("value",r),this.emit("click",n,r)}},t.prototype.extractData=function(){var t=i.queryAll(s,this.get("main")),e=[],n=null;t.forEach(function(t){var r=i.getData(t,"value");if(e.push({value:r,name:t.innerHTML}),null!==t.getAttribute("data-checked"))n=r}),this.set("datasource",e),this.set("value",n)},t.prototype.getHtml=function(){var t=this.get("datasource")||[],e=[],n=this;return t.forEach(function(t){e.push(n.getItemHtml(t))}),e.join("")},t.prototype.getItemHtml=function(t){var e=this.get("value");if(t.value===e)t.checked=" data-checked";return r(a,t)},t.prototype.repaint=function(){if(this.is("prerender"))return void this.removeState("prerender");var t=this.get("value");this.get("main").innerHTML=this.getHtml(),this.set("value",t)},n.inherits(t,o),require("./main").register(t),t});