define("saber-widget/base/dom",["require","saber-lang/bind","saber-lang/function/debounce","../main"],function(require){function e(e,t,n){var i=e.domEvents[t[o]][n.type];if(i)i.forEach(function(e){e.call(this,n)},e)}function t(t,i){var r=n(t);r=r?r[i.type]:[],r.forEach(function(n){e(n,t,i)})}function n(e){if(window===e)return s.win;if(document===e)return s.doc;if(document.documentElement===e)return s.root;if(document.body===e)return s.body;else return null}var i=require("saber-lang/bind"),r=require("saber-lang/function/debounce"),a=require("../main"),o="_uiDOMEvent",s={win:{},doc:{},root:{},body:{}},exports={};return exports.addEvent=function(s,u,c){if(!this.domEvents)this.domEvents={};var l=s[o];if(!l)l=s[o]=a.getGUID();var f=this.domEvents[l];if(!f)f=this.domEvents[l]={node:s};var h=n(s);if(h){var p=h[u];if(!p){if(p=h[u]=[],p.handler=i(t,null,s),"resize"===u||"scroll"===u)p.handler=r(p.handler,150);s.addEventListener(u,p.handler,!1)}if(p.indexOf(this)<0)p.push(this)}var d=f[u];if(!d)if(d=f[u]=[],!h)d.handler=i(e,null,this,s),s.addEventListener(u,d.handler,!1);if(d.indexOf(c)<0)d.push(c)},exports.removeEvent=function(e,t,i){var r=this.domEvents;if(r)if(r=r[e[o]],r&&r[t]){var a,s=r[t];if(i){if(a=s.indexOf(i),a>=0)s.splice(a,1)}else s.length=0;var u=n(e);if(!s.length){if(s.handler)e.removeEventListener(t,s.handler,!1);if(s.length=0,delete r[t],"node"===Object.keys(r).join(""))r=null,delete this.domEvents[e[o]];if(u&&u[t])if(a=u[t].indexOf(this),a>=0)u[t].splice(a,1)}if(u)if(s=u[t],s&&!s.length)e.removeEventListener(t,s.handler,!1),s.length=0,delete u[t];s=null}},exports.clearEvents=function(e){var t=this.domEvents;if(t){var n;if(!e){for(n in t)if(t.hasOwnProperty(n))this.clearEvents(t[n].node);return void(this.domEvents=null)}if(n=e[o],t=t[n]){delete t.node;for(var i in t)if(t.hasOwnProperty(i))this.removeEvent(e,i)}if(n)delete this.domEvents[n]}},exports});