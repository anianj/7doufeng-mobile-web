define("saber-viewport/Page",["require","saber-dom","saber-promise","saber-emitter"],function(require){function t(t){if(t.main&&t.main.parentNode)t.main.parentNode.removeChild(t.main);t.main=null,t.viewport=null}function e(t,e,n){n=n||{},i.mixin(this),this.data=n.data||{},this.url=t,this.viewport=e,this.cached=n.cached,this.hasVisited=!!n.hasVisited,this.main=n.main||document.createElement("div")}var n=require("saber-dom"),r=require("saber-promise"),i=require("saber-emitter"),o="data-viewport",s=o+"-bar",a=o+"-fixed";return e.prototype.getBar=function(){var t=this.main,e=n.queryAll("["+s+"]",t),r={};return e.forEach(function(t){r[t.getAttribute(s)]=t}),r},e.prototype.getFixed=function(){var t=this.main;return n.queryAll("["+a+"]",t)},e.prototype.clone=function(t){var n=new e(this.url,this.viewport,{cached:t.cached,main:this.main,data:this.data,hasVisited:this.hasVisited});return n},e.prototype.enter=function(t,e){if(!this.main)return r.rejected();else return this.viewport.transition(this,t,e)},e.prototype.remove=function(e){if(!this.cached||e===!0)t(this);else if(this.main&&this.main.parentNode)this.main.parentNode.removeChild(this.main)},e});