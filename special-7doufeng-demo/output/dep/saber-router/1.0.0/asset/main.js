define("saber-router/main",["require","saber-lang/extend","./URL","./config"],function(require){function t(t){var e=-1;return p.some(function(n,r){if(n.path.toString()===t.toString())e=r;return-1!==e}),e}function e(t,e){for(var n,r={},i=e.params||[],o=t.match(e.path)||[],s=1;s<o.length;s++)n=i[s-1]||"$"+s,r[n]=decodeURIComponent(o[s]);return r}function n(t,e,n){return t=t||c.path,new f(t,{query:e,base:n})}function r(t,r){if(r=r||{},!(t instanceof f))t=n(t,null,l);if(t.equal(l)&&!r.force)return t;var i,o,s=u({},t.getQuery());if(p.some(function(n){if(n.path instanceof RegExp){if(n.path.test(t.getPath()))i=n,s=u(e(t.getPath(),n),s)}else if(t.equalPath(n.path))i=n;if(!n.path)o=n;return!!i}),i=i||o,!i)throw new Error("can not found route for: "+t.getPath());else i.fn.call(i.thisArg,t.getPath(),s,t.toString(),r);return l=t,t}function i(t){var e={params:[]};return e.path=t.replace(/:([^/~]+)/g,function(t,n){return e.params.push(n),"([^/~]+)"}),e.path=new RegExp(e.path+"(?:~|$)"),e}function o(t,e,n){var r={path:t,fn:e,thisArg:n};if(!(t instanceof RegExp)&&t.indexOf(":")>=0)r=u(r,i(t));p.push(r)}function s(t){var e=location.href.split("#")[0];location.replace(e+"#"+t)}function a(){var t=r(location.hash);if(t.isRelative)s(t.toString())}var u=require("saber-lang/extend"),f=require("./URL"),c=require("./config"),l={},p=[],exports={};return exports.reset=function(t,e,r){if(r=r||{},r.silent)l=t=n(t,e,l);else r.silent=!0,exports.redirect(t,e,r);s(t.toString())},exports.config=function(t){t=t||{},u(c,t)},exports.add=function(e,n,r){if(t(e)>=0)throw new Error("path has been existed");o(e,n,r)},exports.remove=function(e){var n=t(e);if(n>=0)p.splice(n,1)},exports.clear=function(){p=[],l={}},exports.redirect=function(t,e,i){var o=Array.prototype.slice.call(arguments);if("[object Boolean]"===Object.prototype.toString.call(o[o.length-1]))i={force:o.pop()},e=o[1];if(t=n(t,e,l),r(t,i),!i||!i.silent)location.hash="#"+t.toString()},exports.start=function(){window.addEventListener("hashchange",a,!1),exports.redirect(location.hash)},exports.stop=function(){window.removeEventListener("hashchange",a,!1)},exports}),define("saber-router",["saber-router/main"],function(t){return t});