define("saber-promise/promise",[],function(){function e(e){return"function"==typeof e}function t(e){return"[object Object]"===Object.prototype.toString.call(e)}function n(i,r){if(t(r)||e(r)){var o;try{var a=r.then;if(e(a))a.call(r,function(e){if(!o)n(i,e),o=!0},function(e){if(!o)i.reject(e),o=!0});else i.fulfill(r)}catch(s){if(!h)throw s;else if(!o)c(s),i.reject(s)}}else i.fulfill(r)}function i(e,t,i){return function(r){try{var o=i(r);if(o===t)throw new TypeError;n(e,o)}catch(a){if(h)c(a),e.reject(a);else throw a}}}function r(e,t,n){if(e.status===t)d(function(){n(e.data)});else if(t===f.FULFILLED)e.fulfillList.push(n);else if(t===f.REJECTED)e.rejectList.push(n)}function o(e){var t=e.status===f.FULFILLED?e.fulfillList:e.rejectList;if(u(e),t.length)d(function(){for(var n;n=t.shift();)n(e.data)})}function a(t,n,o){var a=new l,u=s(a);if(e(n))n=i(a,u,n);else n=function(e){a.fulfill(e)};if(r(t,f.FULFILLED,n),e(o))o=i(a,u,o);else o=function(e){a.reject(e)};return r(t,f.REJECTED,o),u}function s(e){return{then:function(t,n){return a(e,t,n)}}}function u(e){var t=e.status===f.FULFILLED?"resolve":"reject";if(p)l.emit(t,e.data)}function c(e){if(p)l.emit("exception",e)}function l(){this.status=f.PENDING,this.fulfillList=[],this.rejectList=[]}var f={PENDING:0,FULFILLED:1,REJECTED:2},h=!0,p=!1,d=function(){function t(){var e,t=r.length;for(e=0;t>e;e++)r[e]();r.splice(0,e)}var n,i,r=[],o="promise";if("function"==typeof setImmediate)n=setImmediate;else if(i=window.MutationObserver||window.webKitMutationObserver){var a=new i(function(e){var n=e[0];if(n.attributeName===o)t()}),s=document.createElement("div");a.observe(s,{attributes:!0}),n=function(e){r.push(e),s.setAttribute(o,Date.now?Date.now():(new Date).getTime())}}else if(e(window.postMessage))window.addEventListener("message",function(e){if(e.source===window&&e.data===o)t()},!1),n=function(e){r.push(e),window.postMessage(o,"*")};else n=function(e){setTimeout(e,0)};return n}();return l.enableGlobalEvent=function(e){e.mixin(this),p=!0},l.disableExceptionCapture=function(){h=!1},l.enableExceptionCapture=function(){h=!0},l.all=function(e){function t(t){return function(n){if(o[t]=n,r++,r>=e.length)i.fulfill(o)}}function n(e){i.reject(e)}if(!Array.isArray(e))e=Array.prototype.slice.call(arguments);var i=new l,r=0,o=[];return e.forEach(function(e,i){e.then(t(i),n)}),i.promise()},l.promise=function(e){var t=new l;return e(t),t.promise()},l.rejected=function(e){return this.promise(function(t){t.reject(e)})},l.fulfilled=function(e){return this.promise(function(t){t.fulfill(e)})},l.resolved=l.fulfilled,l.prototype.fulfill=function(e){if(this.status===f.PENDING)this.data=e,this.status=f.FULFILLED,o(this)},l.prototype.resolve=l.prototype.fulfill,l.prototype.reject=function(e){if(this.status===f.PENDING)this.data=e,this.status=f.REJECTED,o(this)},l.prototype.promise=function(){return s(this)},l}),define("saber-promise",["saber-promise/promise"],function(e){return e}),define("saber-emitter/emitter",[],function(){function e(){}var t=e.prototype;return t._getEvents=function(){if(!this._events)this._events={};return this._events},t._getMaxListeners=function(){if(isNaN(this.maxListeners))this.maxListeners=10;return this.maxListeners},t.on=function(e,t){var n=this._getEvents(),i=this._getMaxListeners();n[e]=n[e]||[];var r=n[e].length;if(r>=i&&0!==i)throw new RangeError("Warning: possible Emitter memory leak detected. "+r+" listeners added.");return n[e].push(t),this},t.once=function(e,t){function n(){i.off(e,n),t.apply(this,arguments)}var i=this;return n.listener=t,this.on(e,n),this},t.off=function(e,t){var n=this._getEvents();if(0===arguments.length)return this._events={},this;var i=n[e];if(!i)return this;if(1===arguments.length)return delete n[e],this;for(var r,o=0;o<i.length;o++)if(r=i[o],r===t||r.listener===t){i.splice(o,1);break}return this},t.emit=function(e){var t=this._getEvents(),n=t[e],i=Array.prototype.slice.call(arguments,1);if(n){n=n.slice(0);for(var r=0,o=n.length;o>r;r++)n[r].apply(this,i)}return this},t.listeners=function(e){var t=this._getEvents();return t[e]||[]},t.setMaxListeners=function(e){return this.maxListeners=e,this},e.mixin=function(t){for(var n in e.prototype)t[n]=e.prototype[n];return t},e}),define("saber-emitter",["saber-emitter/emitter"],function(e){return e}),define("saber-lang/bind",[],function(){function e(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}}return e}),define("saber-tap/tap",["require","saber-lang/bind"],function(require){"use strict";function e(){if(!("ontouchstart"in window))return!0;if(c||o&&l)return!0;else return!1}function t(e){var t=e.onclick;e.addEventListener("click",function(e){t(e)},!1),e.onclick=null}function n(n){if(this.layer=n,this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.startX=0,this.startY=0,this.lastTouchIdentifier=0,this.boundary=10,!n||!n.nodeType)throw new TypeError("layer must be a HTMLElement.");if(!e()){if(this.onClick=i(this.onClick,this),this.onMouse=i(this.onMouse,this),this.onTouchStart=i(this.onTouchStart,this),this.onTouchMove=i(this.onTouchMove,this),this.onTouchEnd=i(this.onTouchEnd,this),this.onTouchCancel=i(this.onTouchCancel,this),this.bindEvents(),!Event.prototype.stopImmediatePropagation)n.addEventListener=function(e,t,i){var r=Node.prototype.addEventListener;if("click"===e){if(!t.hijacked)t.hijacked=function(e){if(!e.propagationStopped)t(e)};r.call(n,e,t.hijacked,i)}else r.call(n,e,t,i)},n.removeEventListener=function(e,t,i){var r=Node.prototype.removeEventListener;if("click"===e)r.call(n,e,t.hijacked||t,i);else r.call(n,e,t,i)};if("function"==typeof n.onclick)t(n)}}var i=require("saber-lang/bind"),r=navigator.userAgent,o=r.indexOf("Android")>0,a=/iP(ad|hone|od)/.test(r),s=a&&/OS 4_\d(_\d)?/.test(r),u=a&&/OS ([6-9]|\d{2})_\d/.test(r),c="chrome"in window,l=r.indexOf("UCBrowser")>0;return n.prototype.bindEvents=function(){var e=this.layer;if(o)e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0);e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1)},n.prototype.onMouse=function(e){if(!this.targetElement)return!0;if(e.forwardedTouchEvent)return!0;if(!e.cancelable)return!0;if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(e.stopImmediatePropagation)e.stopImmediatePropagation();else e.propagationStopped=!0;return e.stopPropagation(),e.preventDefault(),!1}return!0},n.prototype.getTargetElementFromEventTarget=function(e){if(e.nodeType===Node.TEXT_NODE)return e.parentNode;else return e},n.prototype.updateScrollParent=function(e){var t=e.tapScrollParent;if(!t||!t.contains(e)){var n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.tapScrollParent=n;break}n=n.parentElement}while(n)}if(t)t.tapLastScrollTop=t.scrollTop},n.prototype.onClick=function(e){if(this.trackingClick)return this.targetElement=null,this.trackingClick=!1,!0;if("submit"===e.target.type&&0===e.detail)return!0;var t=this.onMouse(e);if(!t)this.targetElement=null;return t},n.prototype.onTouchStart=function(e){if(e.targetTouches.length>1)return!0;var t,n=this.getTargetElementFromEventTarget(e.target),i=e.targetTouches[0];if(a){if(t=window.getSelection(),t.rangeCount&&!t.isCollapsed)return!0;if(!this.isIOS4){if(i.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=i.identifier,this.updateScrollParent(n)}}if(this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=n,this.startX=i.pageX,this.startY=i.pageY,e.timeStamp-this.lastClickTime<200)e.preventDefault();return!0},n.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.boundary;if(Math.abs(t.pageX-this.startX)>n||Math.abs(t.pageY-this.startY)>n)return!0;else return!1},n.prototype.onTouchMove=function(e){if(!this.trackingClick)return!0;var t=this.getTargetElementFromEventTarget(e.target);if(this.targetElement!==t||this.touchHasMoved(e))this.trackingClick=!1,this.targetElement=null;return!0},n.prototype.findControl=function(e){if(void 0!==e.control)return e.control;if(e.htmlFor)return document.getElementById(e.htmlFor);else return e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},n.prototype.focus=function(e){if(a&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type){var t=e.value.length;e.setSelectionRange(t,t)}else e.focus()},n.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!o;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},n.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(a&&"file"===e.type||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},n.prototype.sendClick=function(e,t){if(document.activeElement&&document.activeElement!==e)document.activeElement.blur();var n=t.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(this.determineEventType(e),!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,e.dispatchEvent(i)},n.prototype.determineEventType=function(e){if(o&&"select"===e.tagName.toLowerCase())return"mousedown";else return"click"},n.prototype.onTouchEnd=function(e){var t=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;this.cancelNextClick=!1,this.lastClickTime=e.timeStamp;var n=this.trackingClickStart;if(this.trackingClick=!1,this.trackingClickStart=0,u){var i=e.changedTouches[0];t=document.elementFromPoint(i.pageX-window.pageXOffset,i.pageY-window.pageYOffset)||t,t.tapScrollParent=this.targetElement.tapScrollParent}var r=t.tagName.toLowerCase();if("label"===r){var c=this.findControl(t);if(c){if(this.focus(t),o)return!1;t=c}}else if(this.needsFocus(t)){if(e.timeStamp-n>100||a&&window.top!==window&&"input"===r)return this.targetElement=null,!1;if(this.focus(t),!s||"select"!==r)this.targetElement=null,e.preventDefault();return!1}if(a&&!s){var l=t.tapScrollParent;if(l&&l.tapLastScrollTop!==l.scrollTop)return!0}if(!this.needsClick(t))e.preventDefault(),this.sendClick(t,e);return!1},n.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},n.prototype.destroy=function(){var e=this.layer;if(o)e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0);e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},n.mixin=function(e){if("string"==typeof e)e=document.getElementById(e);return new n(e)},n}),define("saber-tap",["saber-tap/tap"],function(e){return e}),define("saber-lang/extend",[],function(){function e(e,t){for(var n=1,i=arguments.length;i>n;n++)if(t=arguments[n]){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]}else;return e}return e}),define("saber-lang/curry",[],function(){function e(e){var t=[].slice.call(arguments,1);return function(){var n=t.concat([].slice.call(arguments));return e.apply(this,n)}}return e}),define("saber-lang/inherits",[],function(){function e(e,t){var n=function(){};n.prototype=t.prototype;var i=e.prototype,r=e.prototype=new n;for(var o in i)r[o]=i[o];return e.prototype.constructor=e,e}return e}),define("saber-uri/component/Abstract",[],function(){function e(){var e=Array.prototype.slice.call(arguments);this.set.apply(this,e)}return e.prototype.get=function(){return this.data},e.prototype.set=function(e){this.data=e||""},e.prototype.add=function(e){this.set(e)},e.prototype.remove=function(){this.data=""},e.prototype.toString=function(){return this.data.toString()},e.prototype.equal=function(t){if(t instanceof e)t=t.get();return this.data==t},e}),define("saber-uri/component/Path",["require","saber-lang/inherits","./Abstract"],function(require){function e(e){if(!e)e="/";return e}function t(e){return e=e.split("/"),e.pop(),e.join("/")}function n(e,t){for(var n,i=0,r=e.length-1;n=e[r];r--)if("."===n)e.splice(r,1);else if(".."===n)e.splice(r,1),i++;else if(i)e.splice(r,1),i--;if(t)for(;i-->0;)e.unshift("..");return e}function i(e,t){o.call(this,e,t)}var r=require("saber-lang/inherits"),o=require("./Abstract");return i.resolve=function(e,i){if(i=i||"","/"===i.charAt(0))return i;var r="/"===e.charAt(0),o=!1;if(i)e=t(e),o="/"===i.charAt(i.length-1);else if(e.length>1)o="/"===e.charAt(e.length-1);var a=e.split("/").concat(i.split("/")).filter(function(e){return!!e});return a=n(a,!r),(r?"/":"")+a.join("/")+(o?"/":"")},r(i,o),i.prototype.set=function(e,t){if(t instanceof i)t=t.get();var n=[e||""];if(t)n.unshift(t);this.data=i.resolve.apply(i,n)},i.prototype.equal=function(t){var n=e(this.data);if(t instanceof i)t=e(t.get());else t=e(i.resolve(t||""));return n===t},i.prototype.resolve=function(e,t){if(e instanceof i)e=e.get();var n=[this.data];if(t)n.unshift(e);else n.push(e);this.data=i.resolve.apply(i,n)},i}),define("saber-uri/util/parse-query",[],function(){function e(e){var t={};e=e.split("&");var n,i;return e.forEach(function(e){if(e)if(e=e.split("="),n=e[0],i=e.length>=2?decodeURIComponent(e[1]):null,t[n]){if(!Array.isArray(t[n]))t[n]=[t[n]];t[n].push(i)}else t[n]=i}),t}return e}),define("saber-uri/util/stringify-query",[],function(){function e(e){var t,n=[];return Object.keys(e).forEach(function(i){if(t=e[i],!Array.isArray(t))t=[t];t.forEach(function(e){if(null===e)n.push(i);else n.push(i+"="+encodeURIComponent(e||""))})}),n.join("&")}return e}),define("saber-uri/component/Query",["require","saber-lang/inherits","saber-lang/extend","./Abstract","../util/parse-query","../util/stringify-query"],function(require){function e(e){return"[object Object]"===Object.prototype.toString.call(e)}function t(e){return"string"==typeof e}function n(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;e=e.slice(0),e=e.slice(0),e.sort(),t.sort();for(var n=!0,i=0,r=e.length;n&&r>i;i++)n=e[i]==t[i];return n}function i(t,i){if(!e(t)||!e(i))return!1;var r=Object.keys(t),o=Object.keys(i);if(r.length!==o.length)return!1;for(var a,s,u=!0,c=0;u&&(a=r[c]);c++){if(!i.hasOwnProperty(a)){u=!1;break}if(s=t[a],Array.isArray(s))u=n(s,i[a]);else u=s==i[a]}return u}function r(e){if(Array.isArray(e))e=e.map(function(e){return decodeURIComponent(e)});else e=decodeURIComponent(e);return e}function o(e,t,n){var i=n[e];if(t=r(t),i){if(!Array.isArray(i))i=[i];if(Array.isArray(t))i=i.concat(t);else i.push(t)}else i=t;return n[e]=i,n}function a(e){e=e||{},c.call(this,e)}var s=require("saber-lang/inherits"),u=require("saber-lang/extend"),c=require("./Abstract"),l=require("../util/parse-query"),f=require("../util/stringify-query"),h="?";return s(a,c),a.prototype.set=function(){if(1===arguments.length){var t=arguments[0];if(e(t)){var n=this.data={};Object.keys(t).forEach(function(e){n[e]=r(t[e])})}else this.data=l(t)}else this.data[arguments[0]]=decodeURIComponent(arguments[1])},a.prototype.get=function(e){return e?this.data[e]:u({},this.data)},a.prototype.toString=function(e){e=e||h;var t=f(this.data);return t?e+t:""},a.prototype.equal=function(e){if(t(e))e=l(e);else if(e instanceof a)e=e.get();return i(this.data,e)},a.prototype.add=function(t,n){var i=this.data;if(e(t))Object.keys(t).forEach(function(e){o(e,t[e],i)});else o(t,n,i);this.data=i},a.prototype.remove=function(e){if(!e)this.data={};else if(this.data.hasOwnProperty(e))delete this.data[e]},a}),define("saber-router/config",[],function(){return{index:"",path:"/"}}),define("saber-router/URL",["require","saber-uri/component/Path","saber-uri/component/Query","./config"],function(require){function e(e){if("/"===e.charAt(e.length-1))e+=r.index;return e}function t(e,t){t=t||{};var r=t.base||{};if(e=e.trim(),"#"===e.charAt(0))e=e.substring(1);e=e.split(o);var a=e[0].trim();this.isRelative="/"!==a.charAt(0),this.path=new n(a,r.path);var s=e[1]&&e[1].trim();if(this.query=new i(s||""),t.query)this.query.add(t.query)}var n=require("saber-uri/component/Path"),i=require("saber-uri/component/Query"),r=require("./config"),o="~";return t.prototype.toString=function(){return this.path.toString()+this.query.toString(o)},t.prototype.equalPath=function(t){var n=e(this.path.get());return t=e(t),n===t},t.prototype.equal=function(e){return this.query.equal(e.query)&&this.equalPath(e.path.get())},t.prototype.getQuery=function(){return this.query.get()},t.prototype.addQuery=function(e,t){this.query.add(e,t)},t.prototype.getPath=function(){return this.path.get()},t}),define("saber-router/main",["require","saber-lang/extend","./URL","./config"],function(require){function e(e){var t=-1;return h.some(function(n,i){if(n.path.toString()===e.toString())t=i;return-1!==t}),t}function t(e,t){for(var n,i={},r=t.params||[],o=e.match(t.path)||[],a=1;a<o.length;a++)n=r[a-1]||"$"+a,i[n]=decodeURIComponent(o[a]);return i}function n(e,t,n){return e=e||l.path,new c(e,{query:t,base:n})}function i(e,i){if(i=i||{},!(e instanceof c))e=n(e,null,f);if(e.equal(f)&&!i.force)return e;var r,o,a=u({},e.getQuery());if(h.some(function(n){if(n.path instanceof RegExp){if(n.path.test(e.getPath()))r=n,a=u(t(e.getPath(),n),a)}else if(e.equalPath(n.path))r=n;if(!n.path)o=n;return!!r}),r=r||o,!r)throw new Error("can not found route for: "+e.getPath());else r.fn.call(r.thisArg,e.getPath(),a,e.toString(),i);return f=e,e}function r(e){var t={params:[]};return t.path=e.replace(/:([^/~]+)/g,function(e,n){return t.params.push(n),"([^/~]+)"}),t.path=new RegExp(t.path+"(?:~|$)"),t}function o(e,t,n){var i={path:e,fn:t,thisArg:n};if(!(e instanceof RegExp)&&e.indexOf(":")>=0)i=u(i,r(e));h.push(i)}function a(e){var t=location.href.split("#")[0];location.replace(t+"#"+e)}function s(){var e=i(location.hash);if(e.isRelative)a(e.toString())}var u=require("saber-lang/extend"),c=require("./URL"),l=require("./config"),f={},h=[],exports={};return exports.reset=function(e,t,i){if(i=i||{},i.silent)f=e=n(e,t,f);else i.silent=!0,exports.redirect(e,t,i);a(e.toString())},exports.config=function(e){e=e||{},u(l,e)},exports.add=function(t,n,i){if(e(t)>=0)throw new Error("path has been existed");o(t,n,i)},exports.remove=function(t){var n=e(t);if(n>=0)h.splice(n,1)},exports.clear=function(){h=[],f={}},exports.redirect=function(e,t,r){var o=Array.prototype.slice.call(arguments);if("[object Boolean]"===Object.prototype.toString.call(o[o.length-1]))r={force:o.pop()},t=o[1];if(e=n(e,t,f),i(e,r),!r||!r.silent)location.hash="#"+e.toString()},exports.start=function(){window.addEventListener("hashchange",s,!1),exports.redirect(location.hash)},exports.stop=function(){window.removeEventListener("hashchange",s,!1)},exports}),define("saber-router",["saber-router/main"],function(e){return e}),define("saber-dom/selector",[],function(){var exports={};return exports.g=function(e){if(!e)return null;else return"string"==typeof e?document.getElementById(e):e},exports.query=function(e,t){if("string"!=typeof e)return e;else return t=t||document.body,t.querySelector(e)},exports.queryAll=function(e,t){if(Array.isArray(e))return e;t=t||document.body;var n=t.querySelectorAll(e);return Array.prototype.slice.call(n)},exports.matches=function(e,t){var n=Element.prototype,i=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector;if(i)return i.call(e,t);for(var r=exports.queryAll(t,e.parentNode),o=0;o<r.length;o++)if(r[o]===e)return!0;return!1},exports}),define("saber-dom/css",[],function(){function e(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})}function t(t){if("-"!==t.charAt(0)){var n=i.style,o=e(t);if(!(o in n)){o=o.charAt(0).toUpperCase()+o.substring(1);for(var a,s=0;a=r[s];s++)if(a+o in n){t="-"+a+"-"+t;break}}}return t}var exports={},n=document.defaultView.getComputedStyle,i=document.createElement("div"),r=["webkit","ms","o"];return exports.getStyle=function(i,r){return r=t(r),i.style[e(r)]||n(i).getPropertyValue(r)},exports.setStyle=function(n,i,r){i=t(i),n.style[e(i)]=r},exports.show=function(e){if("none"===exports.getStyle(e,"display"))e.style.display=null},exports.hide=function(e){e.style.display="none"},exports.addClass=function(e,t){if(e.classList)e.classList.add(t);else{for(var n=e.className?e.className.split(/\s+/):[],i=0,r=n.length;r>i;i++)if(n[i]===t)return e;n.push(t),e.className=n.join(" ")}return e},exports.removeClass=function(e,t){if(e.classList)e.classList.remove(t);else{for(var n=e.className?e.className.split(/\s+/):[],i=0,r=n.length;r>i;i++)if(n[i]===t)n.splice(i,1),i--;e.className=n.join(" ")}return e},exports.toggleClass=function(e,t,n){return n="boolean"==typeof n?n:!exports.hasClass(e,t),exports[n?"addClass":"removeClass"](e,t),e},exports.hasClass=function(e,t){if(e.classList)return e.classList.contains(t);for(var n=e.className.split(/\s+/),i=0,r=n.length;r>i;i++)if(n[i]===t)return!0;return!1},exports.position=function(e,t){var n={},i=e.getBoundingClientRect();if(t){var r=t.getBoundingClientRect();n.left=i.left-r.left,n.top=i.top-r.top}else n.left=i.left+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),n.top=i.top+Math.max(document.documentElement.scrollTop,document.body.scrollTop);return n},exports}),define("saber-dom/traversal",["require","./selector"],function(require){var e=require("./selector").matches,exports={};return exports.children=function(e){for(var t,n=[],i=e.children,r=0;t=i[r];r++)if(1===t.nodeType)n.push(t);return n},exports.closest=function(t,n,i){i=i||document;do{if(e(t,n))return t;if(t===i)return null}while((t=t.parentNode)&&t!==document);return null},exports}),define("saber-dom/data",[],function(){var exports={},e="data-";return exports.setData=function(t,n,i){t.setAttribute(e+n,i)},exports.getData=function(t,n){return t.getAttribute(e+n)},exports.removeData=function(t,n){t.removeAttribute(e+n)},exports}),define("saber-dom/main",["require","./selector","./css","./traversal","./data"],function(require){function e(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}var exports={};return e(exports,require("./selector")),e(exports,require("./css")),e(exports,require("./traversal")),e(exports,require("./data")),exports}),define("saber-dom",["saber-dom/main"],function(e){return e}),define("saber-viewport/config",[],{transition:!0,duration:.3,timing:"ease",transform:!0,mask:!0,resetScroll:!0,scrollContainer:document.body}),define("saber-viewport/Page",["require","saber-dom","saber-promise","saber-emitter"],function(require){function e(e){if(e.main&&e.main.parentNode)e.main.parentNode.removeChild(e.main);e.main=null,e.viewport=null}function t(e,t,n){n=n||{},r.mixin(this),this.data=n.data||{},this.url=e,this.viewport=t,this.cached=n.cached,this.hasVisited=!!n.hasVisited,this.main=n.main||document.createElement("div")}var n=require("saber-dom"),i=require("saber-promise"),r=require("saber-emitter"),o="data-viewport",a=o+"-bar",s=o+"-fixed";return t.prototype.getBar=function(){var e=this.main,t=n.queryAll("["+a+"]",e),i={};return t.forEach(function(e){i[e.getAttribute(a)]=e}),i},t.prototype.getFixed=function(){var e=this.main;return n.queryAll("["+s+"]",e)},t.prototype.clone=function(e){var n=new t(this.url,this.viewport,{cached:e.cached,main:this.main,data:this.data,hasVisited:this.hasVisited});return n},t.prototype.enter=function(e,t){if(!this.main)return i.rejected();else return this.viewport.transition(this,e,t)},t.prototype.remove=function(t){if(!this.cached||t===!0)e(this);else if(this.main&&this.main.parentNode)this.main.parentNode.removeChild(this.main)},t}),define("saber-viewport/transition",["require","saber-promise","./config"],function(require){function e(e,r){var o=new t;if(n.transition===!1||e===!1||!r.frontPage||r.frontPage.main===r.backPage.main)n.viewport.appendChild(r.backPage.main),o.fulfill();else{var a=i[e||n.transition];if(!a)throw new Error("can not find transition");a(o,r)}return o.promise()}var t=require("saber-promise"),n=require("./config"),i={};return e.register=function(e,t){i[e]=t},e}),define("saber-viewport/mask",[],function(){function e(e){e.stopPropagation(),e.preventDefault()}function t(){n=document.createElement("div"),n.className=exports.className,n.style.cssText+=";display:none;position:fixed;top:0;right:0;bottom:0;left:0;z-index:100";var t=["touchstart","touchmove","touchend"];t.forEach(function(t){n.addEventListener(t,e,!1)}),document.body.appendChild(n)}var n,exports={};return exports.className="saber-viewport-mask",exports.show=function(){if(!n)t();n.style.display=""},exports.hide=function(){if(!n)t();n.style.display="none"},exports}),define("saber-viewport/main",["require","saber-dom","saber-lang/extend","saber-lang/curry","saber-promise","./config","./Page","./transition","./mask"],function(require){function e(){var e=l.viewport;e.style.position="relative"}function t(){var e=l.viewport,t=a.children(e);if(!(t.length<=0)){var n=new f("__blank__");t.forEach(function(e){n.main.appendChild(e)}),e.appendChild(n.main),r=n}}function n(e,t){if(e)e.emit("beforeleave");if(t.emit("beforeenter"),l.mask)p.show()}function i(e,t){if(l.mask)p.hide();if(e)if(e.emit("afterleave"),e.main!==t.main)e.remove();if(t.emit("afterenter"),o=null,r=t,t.hasVisited)m=m.slice(0,m.indexOf(t.url));m.push(t.url)}var r,o,a=require("saber-dom"),s=require("saber-lang/extend"),u=require("saber-lang/curry"),c=require("saber-promise"),l=require("./config"),f=require("./Page"),h=require("./transition"),p=require("./mask"),d={},m=[],g={before:function(e,t){var n=l.scrollContainer,i=e.data.scrollTop=n.scrollTop,r=t.data.scrollTop||0;t.main.style.marginTop=i-r+"px"},after:function(e,t){var n=l.scrollContainer;t.main.style.marginTop=null,setTimeout(function(){n.scrollTop=t.data.scrollTop||0},10)}},v={};return v.transition=function(e,t,a){if(e!==o)return c.rejected();if(a=a||{},a.frontPage=r,a.backPage=e,a.processor={},l.resetScroll)a.processor.scroll=g;return n(r,e),h(t,a).then(u(i,r,e))},{init:function(n,i){if("string"==typeof n||n instanceof String)n=document.getElementById(n);l=s(l,i),l.viewport=n,e(),t()},load:function(e,t){t=t||{};var n;if(!t.noCache)n=d[e];if(!n)n=new f(e,v,t);else n=n.clone(t);if(t.cached)d[e]=n;else if(d[e])delete d[e];if(o)if(o.remove(!0),d[o.url])delete d[o.url];return n.hasVisited=m.indexOf(e)>=0,o=n},delCache:function(e){if(!e)d={};else if(d[e])delete d[e]}}}),define("saber-viewport",["saber-viewport/main"],function(e){return e}),define("saber-firework/Abstract",["require","saber-emitter","saber-lang/extend","saber-lang/bind"],function(require){function e(e){var t,n=e.events||{};Object.keys(n).forEach(function(i){if(t=n[i],i.indexOf(":")<0)e.on(i,t);else{var o=i.split(":"),a=o[0].trim();if(i=o[1]&&o[1].trim(),a&&e[a]&&i)e[a].on(i,r(t,e))}})}function t(e){e=e||{},i(this,e),n.mixin(this)}var n=require("saber-emitter"),i=require("saber-lang/extend"),r=require("saber-lang/bind");return t.prototype.init=function(){e(this)},t.prototype.dispose=function(){},t}),function(e){function t(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}function n(){this.raw=[],this.length=0}function i(){return"___"+L++}function r(e,t){var n=new Function;n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function o(e){return O[e]}function a(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function s(e){return e.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(e){return"\\"+e})}function u(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,n){return t[n-0+1]})}function c(e){return e=e.replace(/^\s*\*/,""),u('gv({0},["{1}"])',a(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function l(e,t,n,i,r,o){for(var a=n.length,s=e.split(t),u=0,c=[],l=0,f=s.length;f>l;l++){var h=s[l];if(l){var p=1;for(u++;;){var d=h.indexOf(n);if(0>d){c.push(u>1&&p?t:"",h);break}if(u=i?u-1:0,c.push(u>0&&p?t:"",h.slice(0,d),u>0?n:""),h=h.slice(d+a),p=0,0===u)break}if(0===u)r(c.join("")),o(h),c=[]}else h&&o(h)}if(u>0&&c.length>0)o(t),o(c.join(""))}function f(e,t,n){var i,r=[],o=t.options,s="",u="",h="",p="";if(n)s="ts(",u=")",h=P,p=_,i=o.defaultFilter;return l(e,o.variableOpen,o.variableClose,1,function(e){if(n&&e.indexOf("|")<0&&i)e+="|"+i;var o=e.indexOf("|"),a=(o>0?e.slice(0,o):e).replace(/^\s+/,"").replace(/\s+$/,""),l=o>0?e.slice(o+1):"",d=0===a.indexOf("*"),m=[d?"":s,c(a),d?"":u];if(l){l=f(l,t);for(var g=l.split("|"),v=0,y=g.length;y>v;v++){var b=g[v];if(/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(b)){if(m.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3)m.push(",",RegExp.$3);m.push(")")}}}r.push(h,m.join(""),p)},function(e){r.push(h,n?a(e):e,p)}),r.join("")}function h(e,t){this.value=e,this.engine=t}function p(e,t){this.value=e,this.engine=t,this.children=[],this.cloneProps=[]}function d(e,t){var n=e.stack,i=t?n.find(function(e){return e instanceof t}):n.bottom();if(i){for(var r;(r=n.top())!==i;){if(!r.autoClose)throw new Error(r.type+" must be closed manually: "+r.value);r.autoClose(e)}i.close(e)}return i}function m(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,p.call(this,e,t),this.blocks={}}function g(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,p.call(this,e,t),this.cloneProps=["name"]}function v(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,p.call(this,e,t),this.cloneProps=["name","state","blocks"],this.blocks={}}function y(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,p.call(this,e,t),this.cloneProps=["name","expr"]}function b(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,p.call(this,e,t),this.cloneProps=["name","args"]}function w(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,p.call(this,e,t),this.cloneProps=["name","args"]}function E(e,t){var n=new RegExp(u("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",s(t.options.variableOpen),s(t.options.variableClose)),"i");if(!n.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,p.call(this,e,t),this.cloneProps=["list","item","index"]}function x(e,t){p.call(this,e,t)}function k(e,t){x.call(this,e,t)}function A(e,t){p.call(this,e,t)}function C(e,t){t.target=e;var n=t.engine,i=e.name;if(n.targets[i])switch(n.options.namingConflict){case"override":n.targets[i]=e,t.targets.push(i);case"ignore":break;default:throw new Error("Target exists: "+i)}else n.targets[i]=e,t.targets.push(i)}function S(e,t){N[e]=t,t.prototype.type=e}function T(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]+)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=t({},j)}function q(e,t){function i(){var e;if(f.length>0&&(e=f.join(""))){var n=new h(e,t);if(n.beforeAdd(c),u.top().addChild(n),f=[],t.options.strip&&c.current instanceof p)n.value=e.replace(/^[\x20\t\r]*\n/,"");c.current=n}}var r,o=t.options.commandOpen,a=t.options.commandClose,s=t.options.commandSyntax,u=new n,c={engine:t,targets:[],stack:u,target:null},f=[];
return l(e,o,a,0,function(e){var n=s.exec(e);if(n&&(r=N[n[2].toLowerCase()])&&"function"==typeof r){i();var u=c.current;if(t.options.strip&&u instanceof h)u.value=u.value.replace(/\r?\n[\x20\t]*$/,"\n");if(n[1])u=d(c,r);else{if(u=new r(n[3],t),"function"==typeof u.beforeOpen)u.beforeOpen(c);u.open(c)}c.current=u}else if(!/^\s*\/\//.test(e))f.push(o,e,a);r=null},function(e){f.push(e)}),i(),d(c),c.targets}n.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var t=this.length;t--;){var n=this.raw[t];if(e(n))return n}}};var L=178245,O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},j={html:function(e){return e.replace(/[&<>"']/g,o)},url:encodeURIComponent,raw:function(e){return e}},R='var r="";',P="r+=",_=";",D="return r;";if("undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8)R="var r=[],ri=0;",P="r[ri++]=",D='return r.join("");';h.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;if(!e||t.strip&&/^\s*$/.test(e))return"";else return f(e,this.engine,1)},clone:function(){return this}},p.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();t&&t.addChild(this),e.stack.push(this)},close:function(e){if(e.stack.top()===this)e.stack.pop()},getRendererBody:function(){for(var e=[],t=this.children,n=0;n<t.length;n++)e.push(t[n].getRendererBody());return e.join("")},clone:function(){for(var e=new this.constructor(this.value,this.engine),t=0,n=this.children.length;n>t;t++)e.addChild(this.children[t].clone());for(var t=0,n=this.cloneProps.length;n>t;t++){var i=this.cloneProps[t];e[i]=this[i]}return e}};var M='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';r(m,p),r(g,p),r(v,p),r(y,p),r(b,p),r(w,p),r(E,p),r(x,p),r(k,x),r(A,x);var I={READING:1,READED:2,APPLIED:3,READY:4};v.prototype.applyMaster=m.prototype.applyMaster=function(e){function t(e){var i=e.children;if(i instanceof Array)for(var r=0,o=i.length;o>r;r++){var a=i[r];if(a instanceof g&&n[a.name])a=i[r]=n[a.name];t(a)}}if(this.state>=I.APPLIED)return 1;var n=this.blocks,i=this.engine.targets[e];if(i&&i.applyMaster(i.master))return this.children=i.clone().children,t(this),this.state=I.APPLIED,1;else return void 0},m.prototype.isReady=function(){function e(i){for(var r=0,o=i.children.length;o>r;r++){var a=i.children[r];if(a instanceof v){var s=t.targets[a.name];n=n&&s&&s.isReady(t)}else if(a instanceof p)e(a)}}if(this.state>=I.READY)return 1;var t=this.engine,n=1;if(this.applyMaster(this.master))return e(this),n&&(this.state=I.READY),n;else return void 0},m.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[M,R,this.getRendererBody(),D].join("\n")),t=this.engine;return this.renderer=function(n){return e(n,t)},this.renderer}return null},m.prototype.open=function(e){d(e),p.prototype.open.call(this,e),this.state=I.READING,C(this,e)},y.prototype.open=w.prototype.open=function(e){e.stack.top().addChild(this)},g.prototype.open=function(e){p.prototype.open.call(this,e),(e.imp||e.target).blocks[this.name]=this},k.prototype.open=function(e){var t=new A;t.open(e);var n=d(e,x);n.addChild(this),e.stack.push(this)},A.prototype.open=function(e){var t=d(e,x);t.addChild(this),e.stack.push(this)},v.prototype.open=function(e){this.parent=e.stack.top(),this.target=e.target,p.prototype.open.call(this,e),this.state=I.READING,e.imp=this},w.prototype.close=y.prototype.close=function(){},v.prototype.close=function(e){p.prototype.close.call(this,e),this.state=I.READED,e.imp=null},m.prototype.close=function(e){p.prototype.close.call(this,e),this.state=this.master?I.READED:I.APPLIED,e.target=null},v.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0;for(var n in this.blocks)this.target.blocks[n]=this.blocks[n];this.blocks={},this.close(e)},w.prototype.beforeOpen=v.prototype.beforeOpen=y.prototype.beforeOpen=E.prototype.beforeOpen=b.prototype.beforeOpen=g.prototype.beforeOpen=x.prototype.beforeOpen=h.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var t=new m(i(),e.engine);t.open(e)}},v.prototype.getRendererBody=function(){return this.applyMaster(this.name),p.prototype.getRendererBody.call(this)},w.prototype.getRendererBody=function(){return u("{0}engine.render({2},{{3}}){1}",P,_,a(this.name),f(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,t,n){return(t||"")+a(n)+":"}))},y.prototype.getRendererBody=function(){if(this.expr)return u("v[{0}]={1};",a(this.name),f(this.expr,this.engine));else return""},x.prototype.getRendererBody=function(){return u("if({0}){{1}}",f(this.value,this.engine),p.prototype.getRendererBody.call(this))},A.prototype.getRendererBody=function(){return u("}else{{0}",p.prototype.getRendererBody.call(this))},E.prototype.getRendererBody=function(){return u('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',i(),f(this.list,this.engine),a(this.index||i()),a(this.item),i(),i(),p.prototype.getRendererBody.call(this))},b.prototype.getRendererBody=function(){var e=this.args;return u("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",R,D,P,_,p.prototype.getRendererBody.call(this),a(this.name),e?","+f(e,this.engine):"")};var N={};S("target",m),S("block",g),S("import",v),S("use",w),S("var",y),S("for",E),S("if",x),S("elif",k),S("else",A),S("filter",b),T.prototype.config=function(e){t(this.options,e)},T.prototype.compile=T.prototype.parse=function(e){if(e){var t=q(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},T.prototype.getRenderer=function(e){var t=this.targets[e];if(t)return t.getRenderer();else return void 0},T.prototype.render=function(e,t){var n=this.getRenderer(e);if(n)return n(t);else return""},T.prototype.addFilter=function(e,t){if("function"==typeof t)this.filters[e]=t};var F=new T;if(F.Engine=T,"object"==typeof exports&&"object"==typeof module)exports=module.exports=F;else if("function"==typeof define&&define.amd)define("etpl/main",[],F);else e.etpl=F}(this),define("etpl",["etpl/main"],function(e){return e}),define("saber-lang/main",["require","./inherits","./extend","./curry","./bind"],function(require){return{inherits:require("./inherits"),extend:require("./extend"),curry:require("./curry"),bind:require("./bind")}}),define("saber-lang",["saber-lang/main"],function(e){return e}),define("saber-lang/type",["require"],function(){var exports={},e={};return"Boolean Number String Function Array Date RegExp Object Error".split(" ").forEach(function(t){e["[object "+t+"]"]=t.toLowerCase()}),exports.type=function(t){return null==t?String(t):e[e.toString.call(t)]||"object"},exports.isPlainObject=function(e){return"object"===exports.type(e)&&Object.getPrototypeOf(e)===Object.prototype},exports.isEmptyObject=function(e){if("object"!==exports.type(e))return!1;var t;for(t in e)return!1;return!0},exports.isEmpty=function(e){return null===e||void 0===e||""===e||Array.isArray(e)&&0===e.length||exports.isEmptyObject(e)},exports}),define("saber-widget/main",["require","saber-lang","saber-lang/type"],function(require){var e={},t={configAttr:"s-ui",instanceAttr:"s-id"};e.config=function(e){require("saber-lang").extend(t,e)},e.getConfig=function(e){return t[e]};var n=8652548;e.getGUID=function(e){return e=e||"s",e+n++},e.dispose=function(e){if(!e)for(var t in i)i[t].dispose();else if("string"==typeof e){if(e=this.get(e))e.dispose()}else if("function"==typeof e.dispose)e.dispose();else if(/^\[object\sHTML/.test(Object.prototype.toString.call(e)))this.find(e).forEach(function(e){e.dispose()})},e.find=function(t){var n=this.getConfig("instanceAttr");return[].map.call(t.querySelectorAll("["+n+"]"),function(t){return e.get(t.getAttribute(n))})};var i={};e.add=function(e){var t=i[e.id];if(!t||t!==e)i[e.id]=e},e.remove=function(e){delete i[e.id]},e.get=function(e){return i[e]};var r={};e.register=function(t){if("function"==typeof t){var n=t.prototype.type;if(n in r)throw new Error(n+" is exists!");r[n]=t,e[n.charAt(0).toLowerCase()+n.slice(1)]=function(e,t){if(require("saber-lang/type").isPlainObject(e))t=e||{};else t=t||{},t.main=e;return new r[n](t).render()}}};var o={};return e.registerPlugin=function(e){if("function"==typeof e){var t=e.prototype.type;if(t in o)throw new Error("plugin "+t+" is exists!");o[t]=e}},e.enablePlugin=function(e,t,n){var i=e.plugins||(e.plugins={}),r=i[t];if(!r&&(r=o[t]))r=e.plugins[t]=new r(e,n);if(r)r.enable()},e.disablePlugin=function(e,t){var n=e.plugins;if(n){var i;if(Array.isArray(t))i=t;else if(!t)i=Object.keys(n);else if("string"==typeof t)i=[t];i.forEach(function(e){if(e&&n[e])n[e].disable()})}},e.disposePlugin=function(e,t){var n=e.plugins;if(n){var i;if(Array.isArray(t))i=t;else if(!t)i=Object.keys(n);else if("string"==typeof t)i=[t];i.forEach(function(e){if(e&&n[e])n[e].dispose(),delete n[e]})}},e}),define("saber-widget",["saber-widget/main"],function(e){return e}),define("saber-firework/event",["require","saber-dom","saber-lang/extend"],function(require){function e(e){var t;return y.some(function(n){if(n.detect(e))t=n;return!!t}),t}function t(e,t,n){var i=!1,r=p.queryAll(t,n);return r.some(function(t){return i=t===e}),i}function n(e,n){for(var i=n.target,r=n.type,o=[],a=e.handlers[r]||[];a.delegateCount&&i&&i!==e.ele;){for(var s,u=a.delegateCount,c=0;u>c&&(s=a[c]);c++)if(t(i,s.selector,e.ele)){var l=d({},s);l.thisArg=i,o.push(l)}i=i.parentNode}return o=o.concat(a.slice(a.delegateCount||0))}function i(e){return function(t){var i=n(e,t);t=a(t),i.some(function(n){var i=n.thisArg||e.ele,r=n.fn.call(i,t);if(r===!1)t.preventDefault(),t.stopPropagation();return t.isPropagationStopped()})}}function r(t,n){var i=t.commonEventHandler,r=e(n);if(r)r.on(t.ele,n,i);else t.ele.addEventListener(n,i,!1)}function o(t,n){var i=t.commonEventHandler,r=e(n);if(r)r.off(t.ele,n,i);else t.ele.removeEventListener(n,i,!1)}function a(e){var t=e.stopPropagation;return e.stopPropagation=function(){t.call(this),e[g]=!0},e.isPropagationStopped=function(){return!!e[g]},e}function s(e){return e[m]}function u(e){var t=++v;return e[m]=t,t}function c(e){try{delete e[m]}catch(t){}}function l(e){this.uid=u(e),this.ele=e,this.handlers={},this.commonEventHandler=i(this),b[this.uid]=this}function f(e){var t=s(e);if(t)return b[t];else return new l(e)}function h(e){var t,n=s(e);if(n)t=b[n];return t}var p=require("saber-dom"),d=require("saber-lang/extend"),m="_event_uid",g="_stopped",v=0,y=[],b={};l.prototype.on=function(e,t,n){if(!n)n=t,t=void 0;var i=this.handlers[e];if(!i)i=this.handlers[e]=[],i.delegateCount=0,r(this,e);var o={fn:n,selector:t};if(t)i.delegateCount++,i.splice(i.delegateCount-1,0,o);else i.push(o)},l.prototype.off=function(e,t,n){if(!n)n=t,t=void 0;var i=this.handlers[e]||[];if(i.some(function(e,r){var o=!1;if(e.fn===n&&e.selector===t)i.splice(r,1),o=!0;return o}),i.length<=0)o(this,e)},l.prototype.dispose=function(){var e=this;c(e.ele),Object.keys(e.handlers).forEach(function(t){o(e,t)}),this.ele=null};var exports={};return exports.on=function(e,t,n,i){var r=f(e);r.on(t,n,i)},exports.off=function(e,t,n,i){var r=h(e);if(r)r.off(t,n,i)},exports.one=function(e,t,n,i){if(!i)i=n,n=void 0;var r=function(){var o=Array.prototype.slice.call(arguments),a=i.apply(this,o);return exports.off(e,t,n,r),a};exports.on(e,t,n,r)},exports.clear=function(e){var t=h(e);if(t)t.dispose()},exports.register=function(e){if(e.init)e.init();y.push(e)},exports}),define("saber-firework/config",[],{index:"index",path:"/",template:[],viewport:{transition:!1},processor:{transition:!1},timeout:1e3}),define("saber-firework/View",["require","saber-lang/inherits","saber-dom","etpl","saber-widget","saber-router","./event","./config","./Abstract"],function(require){function e(e,t){return t[h]=function(n){return t.call(e,this,n)}}function t(e){var t,n,i,r=e.domEvents||{};Object.keys(r).forEach(function(o){i=r[o],o=o.split(":"),t=o[0].trim(),n=o[1]?o[1].trim():void 0,e.addDomEvent(e.main,t,n,i)})}function n(e,t){if(!Array.isArray(t))t=[t];t=t.concat(l.template||[]),t=t.join("");var n=new a.Engine;n.options=a.options,n.filters=a.filters;var i=n.compile(t),r=n.render;e.template=n,e.template.render=function(e,t){var n="";if(arguments.length<2||!e)n=i(e||t);else n=r.call(this,e,t);return n}}function i(e){e=e||{},f.call(this,e),this.init(),e.template=this.template}var r=require("saber-lang/inherits"),o=require("saber-dom"),a=require("etpl"),s=require("saber-widget"),u=require("saber-router"),c=require("./event"),l=require("./config"),f=require("./Abstract"),h="__delegate__";return r(i,f),i.prototype.init=function(){if(this.template=this.template||"",Array.isArray(this.template)||"string"==typeof this.template)n(this,this.template);this.bindElements=[],f.prototype.init.call(this)},i.prototype.setMain=function(e){this.main=e},i.prototype.render=function(e){if(this.main){if(this.className)this.main.className+=" "+this.className;this.emit("beforerender",e),this.main.innerHTML=this.template.render(this.templateMainTarget,e),this.emit("afterrender",e)}},i.prototype.ready=function(){t(this),this.emit("ready")},i.prototype.query=function(e,t){return t=t||this.main||document.body,o.query(e,t)},i.prototype.queryAll=function(e,t){return t=t||this.main||document.body,o.queryAll(e,t)},i.prototype.redirect=function(e,t,n){u.redirect(e,t,n)},i.prototype.attachEvent=function(e,t,n,i){if(this.bindElements.indexOf(e)<0)this.bindElements.push(e);c.on(e,t,n,i)},i.prototype.detachEvent=function(e,t,n,i){c.off(e,t,n,i)},i.prototype.addDomEvent=function(t,n,i,r){if(this.bindElements.indexOf(t)<0)this.bindElements.push(t);if(!r)r=i,i=void 0;c.on(t,n,i,e(this,r))},i.prototype.removeDomEvent=function(e,t,n,i){if(!i)i=n,n=void 0;if(i[h])c.off(e,t,n,i[h])},i.prototype.dispose=function(){this.emit("dispose"),this.bindElements.forEach(function(e){c.clear(e)}),this.bindElements=[],s.dispose(this.main),this.main=null},i.prototype.leave=function(){this.emit("leave")},i.prototype.sleep=function(){this.emit("sleep")},i.prototype.wakeup=function(e){this.emit("wakeup",e)},i}),define("saber-firework/Model",["require","saber-lang/inherits","saber-promise","./Abstract"],function(require){function e(e){i.call(this,e),this.init()}var t=require("saber-lang/inherits"),n=require("saber-promise"),i=require("./Abstract");return t(e,i),e.prototype.fetch=function(e){return n.resolved(e)},e.prototype.refetch=function(e){return n.resolved(e)},e}),define("saber-firework/Action",["require","saber-lang/inherits","saber-lang/extend","saber-lang/bind","saber-router","./Abstract","./View","./Model"],function(require){function e(e){o.call(this,e),this.init(),this.emit("init")}var t=require("saber-lang/inherits"),n=require("saber-lang/extend"),i=require("saber-lang/bind"),r=require("saber-router"),o=require("./Abstract"),a=require("./View"),s=require("./Model");return t(e,o),e.prototype.init=function(){var e;if(this.view&&this.view.constructor!==Object)e=this.view.constructor;else e=a;if(this.view=new e(this.view),this.model&&this.model.constructor!==Object)e=this.model.constructor;else e=s;this.model=new e(this.model),o.prototype.init.call(this)},e.prototype.redirect=function(e,t,n){r.redirect(e,t,n)},e.prototype.enter=function(e,t,r,o){return this.path=e,this.options=n({},o),this.view.setMain(r),this.emit("enter"),this.model.fetch(t).then(i(this.view.render,this.view))},e.prototype.wakeup=function(e,t,r){return this.path=e,this.options=n({},r),this.emit("wakeup"),this.model.refetch(t).then(i(this.view.wakeup,this.view))},e.prototype.ready=function(){this.emit("ready"),this.view.ready()},e.prototype.complete=function(){this.emit("complete")},e.prototype.leave=function(){this.emit("leave"),this.view.leave(),this.dispose()},e.prototype.sleep=function(){this.emit("sleep"),this.view.sleep()},e.prototype.dispose=function(){this.view.dispose(),this.model.dispose()},e}),define("saber-firework/main",["require","saber-emitter","saber-promise","saber-tap","saber-lang/extend","saber-lang/bind","saber-lang/curry","saber-router","saber-viewport","./Action","./config"],function(require){function e(e){var t=w.processor||{};return t[e]}function t(e,t){if(clearTimeout(C.statusTimer),e===x&&!t)C.statusTimer=setTimeout(function(){C.status=E},w.timeout);C.status=e}function n(){t(E),s()}function i(){var e;Object.keys(A).forEach(function(t){if(e=A[t],C.action!==e)e.dispose()}),A={},y.delCache()}function r(e){var t=A[e];if(t){if(C.action!==t)t.dispose();delete A[e],y.delCache(e)}}function o(i){function a(e){if(t(x,!0),E("beforetransition"),!e){if(C.action=l,i.cached)A[i.path]=l}else C.action=null;if(C.route=i,C.page=w,C.path=i.path,e)return w.enter(p.type,p).then(m(h.rejected,h));else return w.enter(p.type,p)}function s(){return E("error"),a(!0)}function u(){S.forEach(function(e){l[e]()}),n()}var c=i.options||{};if("[object String]"===Object.prototype.toString.call(i.action))return void window.require([i.action],function(e){i.action=e,o(i)});if(i.path===C.path&&!c.force&&C.action&&C.action.refresh)return void C.action.refresh(i.query,i.options).then(n);if(c.noCache)r(i.path);if(C.action)C.action[A[C.path]?"sleep":"leave"]();var l=A[i.path];if(!l){var f;if(i.action&&i.action.constructor!==Object)f=i.action.constructor;else f=b;l=new f(i.action)}var p=i.transition||{},v=e("transition");if(v)d(p,v(i,C.route)||{});if(i.path===C.path)p.type=!1;var w=y.load(i.path,{cached:i.cached,noCache:c.noCache}),E=function(e,t){return function(n){exports.emit(n,e,t)}}({route:d({},i),action:l,page:w},{route:d({},C.route),action:C.action,page:C.page});w.on("afterenter",g(E,"afterload")),E("beforeload");var k,S=["complete"],T=[i.path,i.query,c];if(!A[i.path])k="enter",T.splice(2,0,w.main),S.unshift("ready");else k="wakeup";l[k].apply(l,T).then(a,s).then(u,n)}function a(e){function t(e){r+=e||k.length,n()}function n(){var o=k[r++];if(!o)i.resolve(e);else if(!o.url||o.url instanceof RegExp&&o.url.test(e.path)||o.url===e.path)o.filter(e,n,t);else n()}var i=new h,r=0;return n(),i.promise()}function s(){function e(e){if(n!==e.path)t(E),v.redirect(e.path,e.query,e.options);else o(e)}if(l&&C.status===E){t(x);var n=l.path;a(l).then(e),l=null}}function u(e,t,n,i,r){l=d({},e),l.path=t,l.query=n,l.options=r,l.url=i,s()}function c(e){var t=d(w,e);if(!Array.isArray(t.template))t.template=[t.template];return t}var l,f=require("saber-emitter"),h=require("saber-promise"),p=require("saber-tap"),d=require("saber-lang/extend"),m=require("saber-lang/bind"),g=require("saber-lang/curry"),v=require("saber-router"),y=require("saber-viewport"),b=require("./Action"),w=require("./config"),E=0,x=1,k=[],A={},C={};C.status=E;var exports={};return f.mixin(exports),exports.load=function(e){if(!Array.isArray(e))e=[e];e.forEach(function(e){v.add(e.path,g(u,e))})},exports.start=function(e,t){var n=c(t);y.init(e,n.viewport),p.mixin(document.body),v.config({index:n.index,path:n.path}),v.start()},exports.addFilter=function(e,t){if(1===arguments.length)t=e,e=null;k.push({url:e,filter:t})},exports.removeFilter=function(e){if(!e)k=[];else{var t,n=k.some(function(n,i){return t=i,n.url.toString()===e.toString()});if(n)k.splice(t,1)}},exports.delCachedAction=function(e){if(e)r(e);else i()},exports}),define("saber-firework",["saber-firework/main"],function(e){return e}),define("index.tpl",[],function(){return"\n"}),define("indexView",["require","./index.tpl"],function(require){var e={};return e.template=require("./index.tpl"),e}),define("indexModel",["require","saber-promise"],function(require){var e=require("saber-promise"),t={};return t.fetch=function(t){return e.resolved(t)},t}),define("index",["require","./indexView","./indexModel"],function(require){var e={};return e.view=require("./indexView"),e.model=require("./indexModel"),e}),define("config",["require","./index"],function(require){return[{path:"/index",action:require("./index")}]}),define("app",["require","saber-promise","saber-firework","./config"],function(require){var e=require("saber-promise"),t=require("saber-firework");e.disableExceptionCapture();var n={index:"index"};return t.load(require("./config")),{init:function(){t.start("viewport",n)}}});