define("saber-firework/View",["require","saber-lang/inherits","saber-dom","etpl","saber-widget","saber-router","./event","./config","./Abstract"],function(require){function e(e,t){return t[f]=function(n){return t.call(e,this,n)}}function t(e){var t,n,r,i=e.domEvents||{};Object.keys(i).forEach(function(s){r=i[s],s=s.split(":"),t=s[0].trim(),n=s[1]?s[1].trim():void 0,e.addDomEvent(e.main,t,n,r)})}function n(e,t){if(!Array.isArray(t))t=[t];t=t.concat(c.template||[]),t=t.join("");var n=new o.Engine;n.options=o.options,n.filters=o.filters;var r=n.compile(t),i=n.render;e.template=n,e.template.render=function(e,t){var n="";if(arguments.length<2||!e)n=r(e||t);else n=i.call(this,e,t);return n}}function r(e){e=e||{},p.call(this,e),this.init(),e.template=this.template}var i=require("saber-lang/inherits"),s=require("saber-dom"),o=require("etpl"),a=require("saber-widget"),u=require("saber-router"),l=require("./event"),c=require("./config"),p=require("./Abstract"),f="__delegate__";return i(r,p),r.prototype.init=function(){if(this.template=this.template||"",Array.isArray(this.template)||"string"==typeof this.template)n(this,this.template);this.bindElements=[],p.prototype.init.call(this)},r.prototype.setMain=function(e){this.main=e},r.prototype.render=function(e){if(this.main){if(this.className)this.main.className+=" "+this.className;this.emit("beforerender",e),this.main.innerHTML=this.template.render(this.templateMainTarget,e),this.emit("afterrender",e)}},r.prototype.ready=function(){t(this),this.emit("ready")},r.prototype.query=function(e,t){return t=t||this.main||document.body,s.query(e,t)},r.prototype.queryAll=function(e,t){return t=t||this.main||document.body,s.queryAll(e,t)},r.prototype.redirect=function(e,t,n){u.redirect(e,t,n)},r.prototype.attachEvent=function(e,t,n,r){if(this.bindElements.indexOf(e)<0)this.bindElements.push(e);l.on(e,t,n,r)},r.prototype.detachEvent=function(e,t,n,r){l.off(e,t,n,r)},r.prototype.addDomEvent=function(t,n,r,i){if(this.bindElements.indexOf(t)<0)this.bindElements.push(t);if(!i)i=r,r=void 0;l.on(t,n,r,e(this,i))},r.prototype.removeDomEvent=function(e,t,n,r){if(!r)r=n,n=void 0;if(r[f])l.off(e,t,n,r[f])},r.prototype.dispose=function(){this.emit("dispose"),this.bindElements.forEach(function(e){l.clear(e)}),this.bindElements=[],a.dispose(this.main),this.main=null},r.prototype.leave=function(){this.emit("leave")},r.prototype.sleep=function(){this.emit("sleep")},r.prototype.wakeup=function(e){this.emit("wakeup",e)},r});